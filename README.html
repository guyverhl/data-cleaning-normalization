<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="data-cleaning-normalization">Data Cleaning Normalization</h1>
<ul>
<li><a href="#datacleaningnormalization">Data Cleaning Normalization</a>
<ul>
<li><a href="#requirement">Requirement</a></li>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#input-csv">Input CSV</a></li>
<li><a href="#check-empty-values">Check Empty Values</a></li>
<li><a href="#normalization">Normalization</a></li>
<li><a href="#tidy-dataframe">Tidy Dataframe</a></li>
</ul>
</li>
<li><a href="#options">Options</a>
<ul>
<li><a href="#print-dataframe">Print Dataframe</a></li>
<li><a href="#modify-column-title">Modify Column Title</a></li>
<li><a href="#modify-cell">Modify cell</a></li>
<li><a href="#count-values-in-selected-column">Count Values in Selected Column</a></li>
<li><a href="#delete-selected-column">Delete Selected Column</a></li>
<li><a href="#delete-selected-row">Delete Selected Row</a></li>
<li><a href="#call-a-cell-value">Call a Cell Value</a></li>
<li><a href="#output-csv">Output CSV</a></li>
<li><a href="#change-text-case">Change Text Case</a></li>
<li><a href="#sorting">Sorting</a></li>
<li><a href="#quit">Quit</a></li>
</ul>
</li>
<li><a href="#helplist">Help List</a></li>
<li><a href="#flow-chart">Flow Chart</a></li>
<li><a href="#appendix">Appendix</a></li>
</ul>
</li>
</ul>
<h1 id="requirement">Requirement</h1>
<p>This script requires <code>pandas</code>, <code>numpy</code> and <code>re</code> library to run, you need to install to run successfully.</p>
<pre class="hljs"><code><div>pip3 install pandas
</div></code></pre>
<h1 id="usage">Usage</h1>
<p>The program is processing the step of data cleaning. It will detect any spaces and empty values, then transform to first normal formal utilizing normalization. After that user can reproduce a cleaned version of the CSV file.</p>
<pre class="hljs"><code><div>python3 individual_ex.py
</div></code></pre>
<h2 id="input-csv">Input CSV</h2>
<p>First input CSV for processing.
<code>CSV name</code> in the current folder with the program or <code>absolute path</code> is accessible.
The input parameter is <code>raw_data</code>. Try except is used to prevent <code>No file or directory</code> error.
User can terminate the program by typing <code>\q</code>.
The error will be printed and force the user to input the correct file or directory again.
This function will return the parameter <code>raw_data</code> to create dataframe.</p>
<pre class="hljs"><code><div>raw_data = <span class="hljs-literal">None</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">input_csv</span><span class="hljs-params">(raw_data)</span>:</span>
    <span class="hljs-keyword">try</span>:
        csv_file = input(<span class="hljs-string">"Input CSV file (staff_dir.csv): "</span>)
        <span class="hljs-keyword">if</span> csv_file == <span class="hljs-string">'\q'</span>: exit()
        raw_data = pd.read_csv(csv_file)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        print(e)
        <span class="hljs-keyword">return</span> input_csv(raw_data)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> raw_data

raw_data = input_csv(raw_data)
df = pd.DataFrame(raw_data)
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>Input CSV file (staff_dir.csv): staff_dir.csv
</div></code></pre>
<h2 id="check-empty-values">Check Empty Values</h2>
<p>Then the program will look for empty values by calling this function automatically.
It requires a global variable <code>df</code>. Firstly, the function will search for any <code>Unnamed</code> column name and scan values in each column to find any column is containing empty values.
After that, the conclusion will be shown and it will return to the main function.</p>
<pre class="hljs"><code><div>check_columns_with_empty_cell(df)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_columns_with_empty_cell</span><span class="hljs-params">(df)</span>:</span>

    df.columns = [<span class="hljs-string">' '</span>.join(i.split()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df.columns]
    empty_cols_name = [value <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> df.columns <span class="hljs-keyword">if</span> <span class="hljs-string">"Unnamed"</span> <span class="hljs-keyword">in</span> value]
    empty_cols = [col <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> df.columns <span class="hljs-keyword">if</span> df[col].isnull().any()]
    print(<span class="hljs-string">"You have"</span>, len(empty_cols_name), <span class="hljs-string">"columns without naming"</span>)
    print(<span class="hljs-string">"You have"</span>, len(empty_cols), <span class="hljs-string">"columns with empty cells"</span>)

    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>You have 0 columns without naming
You have 0 columns with empty cells
</div></code></pre>
<h2 id="normalization">Normalization</h2>
<p>Then the program will normalize dataframe to first normal form by using <code>-r</code> or <code>--run</code> to start.
Global variable <code>df</code> will be used to expend rows containing <code>\r\n</code> to ensure each cell only contain one value.
A list <code>column_with_multi_values</code> is formed to save columns with multiple values.
Then by setting index without the particular column, use <code>.explode()</code> to append the row to perform normalization.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">normalization</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df
    column_with_multi_values = []

    <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> list(df.columns):
        df[col] = [<span class="hljs-string">'('</span>.join(i.split(<span class="hljs-string">"\r\n("</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(df)):
            cell_value = df[col][row]
            cell_value_list = list(map(str, cell_value.split(<span class="hljs-string">"\r\n"</span>)))
            <span class="hljs-keyword">if</span> (len(cell_value_list) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> col <span class="hljs-keyword">in</span> column_with_multi_values): column_with_multi_values.append(col)

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(column_with_multi_values)):
        selected_column = list(column_with_multi_values[i].split(<span class="hljs-string">" "</span>))
        set_index_list = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df.columns <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> selected_column]
        df = df.set_index(set_index_list)
        df = df.apply(<span class="hljs-keyword">lambda</span> x: df[column_with_multi_values[i]].str.split(<span class="hljs-string">'\r\n'</span>).explode())
        df = df.reset_index()

    print(<span class="hljs-string">"Normalization is complete"</span>)
    <span class="hljs-keyword">return</span> tidy_dataframe()
</div></code></pre>
<h2 id="tidy-dataframe">Tidy Dataframe</h2>
<p>Later the program will delete all excessing spaces and replace data automatically.
By continuing the <code>normalization()</code> function, it will eliminate excessive spaces and change to <code>title</code> textcase.
In <code>Location</code>, all strings will change to <code>upper</code> textcase.
In <code>Phone</code>, all special characters will be removed.
In <code>Position</code>, all abbreviations will extend to long format.
After that, the index number will be reset to reproduce as row number.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tidy_dataframe</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> list(df.columns):
        <span class="hljs-keyword">if</span> <span class="hljs-string">'E-mail'</span> <span class="hljs-keyword">in</span> i: <span class="hljs-keyword">continue</span>
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'Location'</span> <span class="hljs-keyword">in</span> i: df[i] = [<span class="hljs-string">''</span>.join(i.split()).upper() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'Phone'</span> <span class="hljs-keyword">in</span> i: df[i] = [re.sub(<span class="hljs-string">r"[^A-Za-z0-9]+"</span>, <span class="hljs-string">""</span>, i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'Position'</span> <span class="hljs-keyword">in</span> i:
            df[i] = [<span class="hljs-string">'('</span>.join(i.split(<span class="hljs-string">' ('</span>)).title() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
            df[i] = [i.replace(<span class="hljs-string">"Assoc."</span>, <span class="hljs-string">"Associate"</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
            df[i] = [re.sub(<span class="hljs-string">r"\bProf\b"</span>, <span class="hljs-string">"Professor"</span>, i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
        <span class="hljs-keyword">else</span>: df[i] = [<span class="hljs-string">' '</span>.join(i.split()).title() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]

    duplicateDFRow = df[df.duplicated()]
    print(<span class="hljs-string">'Duplicated Rows: \n'</span>, duplicateDFRow)
    df = df.drop_duplicates()
    df.reset_index(inplace=<span class="hljs-literal">True</span>)
    <span class="hljs-keyword">del</span> df[<span class="hljs-string">'index'</span>]
    print(<span class="hljs-string">"Diminish spaces and title values"</span>)

    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -r
Normalization is complete
Duplicated Rows: 
     Title Surname   Given Name  E-mail Address Phone Number                 Position Location
15  Prof.    Tang  Akaysha Can   actang@hku.hk     25698751                Professor    MW523
16  Prof.    Tang  Akaysha Can   actang@hku.hk     25698751                Professor    MW538
17  Prof.    Tang  Akaysha Can   actang@hku.hk     25698751  Director Of The Nfe Lab    MW523
18  Prof.    Tang  Akaysha Can   actang@hku.hk     25698751  Director Of The Nfe Lab    MW538
24    Dr.     Lai         Chun  laichun@hku.hk     25698761      Associate Professor    MW623
Diminish spaces and title values
</div></code></pre>
<h1 id="options">Options</h1>
<p>Usage of options</p>
<h2 id="print-dataframe">Print Dataframe</h2>
<p>To print the current dataframe, use <code>-p</code> or <code>--print</code>.
Then it will return to main function.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">if</span> usr_input == <span class="hljs-string">'-p'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--print'</span>:
    print(df)
    main()
</div></code></pre>
<h2 id="modify-column-title">Modify Column Title</h2>
<p>To modify a title in a selected column, use <code>-M</code> or <code>--modify_col_name</code> to change the string.
The local variable <code>col</code> will be formed by asking the user to type the name of a column that want to change, and <code>i</code> will record the changed name.
If else ensure user to input correct column name, otherwise will ask for input again.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modify_column_name</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of column that you want to rename: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> modify_column_name()
    i = input(<span class="hljs-string">"Updated name: "</span>)
    df = df.rename(columns={col: i})
    print(<span class="hljs-string">f'"<span class="hljs-subst">{col}</span>" is changed to "<span class="hljs-subst">{i}</span>".'</span>)
    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -M
[<span class="hljs-string">'Title'</span> <span class="hljs-string">'Surname'</span> <span class="hljs-string">'Given Name'</span> <span class="hljs-string">'Position'</span> <span class="hljs-string">'Location'</span> <span class="hljs-string">'E-mail Address'</span>
<span class="hljs-string">'Phone Number'</span>]
Name of column that you want to rename: Title
Updated name: Rename-Title
<span class="hljs-string">"Title"</span> is changed to <span class="hljs-string">"Rename-Title"</span>.
</div></code></pre>
<h2 id="modify-cell">Modify cell</h2>
<p>To modify a value in a selected cell, use <code>-m</code> or <code>--modify_cell</code> to change the string.
The local variable <code>col</code>, <code>row</code> and <code>value</code> save user's input to locate the specific cell, then change to the value in <code>value</code>.
If else can prevent the user from inputting incorrect column name and row that exceeds the total number of row in the dataframe, and restrict the user to input again.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modify_cell</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df
    print(<span class="hljs-string">"Input row, column and value to a cell that you want to change"</span>)
    print(<span class="hljs-string">"Length of dataframe is"</span>, len(df) - <span class="hljs-number">1</span>, <span class="hljs-string">'\n'</span>, df.columns.values)
    row = input(<span class="hljs-string">"Number of Row: "</span>)
    col = input(<span class="hljs-string">"Name of Column: "</span>)
    <span class="hljs-keyword">if</span> (col == <span class="hljs-string">'\q'</span> <span class="hljs-keyword">or</span> row == <span class="hljs-string">'\q'</span>): <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> row.isnumeric(): <span class="hljs-keyword">return</span> modify_cell()
    row = int(row)
    <span class="hljs-keyword">if</span> row &gt; len(df) - <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> modify_cell()
    value = input(<span class="hljs-string">"Value: "</span>)

    df.iloc[row, df.columns.get_loc(col)] = value
    print(<span class="hljs-string">f'The value of row <span class="hljs-subst">{row}</span> in "<span class="hljs-subst">{col}</span>" is changed to "<span class="hljs-subst">{value}</span>".'</span>)

    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -m
Input row, column and value to a cell that you want to change
Length of dataframe is 16
 [<span class="hljs-string">'Title'</span> <span class="hljs-string">'Surname'</span> <span class="hljs-string">'Given Name'</span> <span class="hljs-string">'Position'</span> <span class="hljs-string">'Location'</span> <span class="hljs-string">'E-mail Address'</span>
 <span class="hljs-string">'Phone Number'</span>]
Number of Row: 1
Name of Column: Title
Value: Mr.
The value of row 1 <span class="hljs-keyword">in</span> <span class="hljs-string">"Title"</span> is changed to <span class="hljs-string">"Mr."</span>.
</div></code></pre>
<h2 id="count-values-in-selected-column">Count Values in Selected Column</h2>
<p>To count the number of values in a specific column, use <code>-C</code> or <code>--count_column</code>.
The local variable <code>col</code> save the selected column from the user and calculate the number of each value.
If else can prevent the user from inputting incorrect column name, and restrict the user to input again.
Then print in the console.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">counting_with_a_column</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df
    print(df.columns.values)
    col = input(<span class="hljs-string">"Select a column to count: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> counting_with_a_column()
    selected_column = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    selected_column = {i: selected_column.count(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> selected_column}
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> selected_column.items():
        print(key, value)
    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -C
[<span class="hljs-string">'Title'</span> <span class="hljs-string">'Surname'</span> <span class="hljs-string">'Given Name'</span> <span class="hljs-string">'E-mail Address'</span> <span class="hljs-string">'Phone Number'</span> <span class="hljs-string">'Position'</span>
 <span class="hljs-string">'Location'</span>]
Select a column to count: Title
Prof. 5
Dr. 14
Ms. 2
Mr. 1
</div></code></pre>
<h2 id="delete-selected-column">Delete Selected Column</h2>
<p>Use <code>-D</code> or <code>--remove_col</code> to delete a selected column.
The local variable <code>i</code> save the name of column from the user to delete.
If else can prevent the user from inputting incorrect column name, and restrict the user to input again.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_selected_column</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    i = input(<span class="hljs-string">"Type the name of column to delete: "</span>)
    <span class="hljs-keyword">if</span> i == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> remove_selected_column()
    <span class="hljs-keyword">else</span>: <span class="hljs-keyword">del</span> df[i]

    print(<span class="hljs-string">f'"<span class="hljs-subst">{i}</span>" is removed.'</span>)

    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -D
[<span class="hljs-string">'Title'</span> <span class="hljs-string">'Surname'</span> <span class="hljs-string">'Given Name'</span> <span class="hljs-string">'Position'</span> <span class="hljs-string">'Location'</span> <span class="hljs-string">'E-mail Address'</span>
 <span class="hljs-string">'Phone Number'</span>]
Type the name of column to delete: Title
<span class="hljs-string">"Title"</span> is removed.
</div></code></pre>
<h2 id="delete-selected-row">Delete Selected Row</h2>
<p>Use <code>-d</code> or <code>--remove_row</code> to delete a selected row.
The local variable <code>row</code> save the number of row from the user to delete.
If else can prevent the user from inputting incorrect number of row, and restrict the user to input again.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_selected_row</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df
    print(len(df))
    row = input(<span class="hljs-string">"Number of row to remove: "</span>)
    <span class="hljs-keyword">if</span> row == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> row.isnumeric(): <span class="hljs-keyword">return</span> remove_selected_row()
    row = int(row)
    <span class="hljs-keyword">if</span> row &gt; len(df) - <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> remove_selected_row()
    df.drop([row], axis=<span class="hljs-number">0</span>, inplace=<span class="hljs-literal">True</span>)
    print(<span class="hljs-string">f'Row <span class="hljs-subst">{row}</span> is removed.'</span>)

    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -d
17
Number of row to remove: 4 
Row 4 is removed.
</div></code></pre>
<h2 id="call-a-cell-value">Call a Cell Value</h2>
<p>Use <code>-v</code> or <code>--view_value</code> to view the value with a selected cell.
The local variable <code>row</code> and <code>col</code> save the input from the user to view a cell value.
If else can prevent the user from inputting incorrect number of row and the name of column, and restrict the user to input again.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive_cell_value</span><span class="hljs-params">()</span>:</span>
    print(<span class="hljs-string">'Length of the row is'</span>, len(df) - <span class="hljs-number">1</span>)
    row = input(<span class="hljs-string">"Number of Row: "</span>)
    <span class="hljs-keyword">if</span> row == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> row.isnumeric(): <span class="hljs-keyword">return</span> receive_cell_value()
    row = int(row)
    <span class="hljs-keyword">if</span> row &gt; len(df) - <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> receive_cell_value()
    
    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of Column: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> receive_cell_value()
    print(<span class="hljs-string">'The value is'</span>, df.loc[row, col])

    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -v
Length of the row is 16
Number of Row: 4
[<span class="hljs-string">'Title'</span> <span class="hljs-string">'Surname'</span> <span class="hljs-string">'Given Name'</span> <span class="hljs-string">'Position'</span> <span class="hljs-string">'Location'</span> <span class="hljs-string">'E-mail Address'</span>
 <span class="hljs-string">'Phone Number'</span>]
Name of Column: Title
The value is Mr.
</div></code></pre>
<h2 id="output-csv">Output CSV</h2>
<p>Use <code>-o</code> or <code>--gen_csv</code> to specify the name of CSV and form a new CSV file.
The local variable <code>output</code> save the name of the new CSV file.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">to_csv</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df
    output = input(<span class="hljs-string">"Name of the new csv file: "</span>)
    <span class="hljs-keyword">if</span> output == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    df.to_csv(<span class="hljs-string">f'<span class="hljs-subst">{output}</span>.csv'</span>, index=<span class="hljs-number">0</span>)
    print(<span class="hljs-string">f'<span class="hljs-subst">{output}</span>.csv is generated.'</span>)

    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -o
Name of the new csv file: output
output.csv is generated.
</div></code></pre>
<h2 id="change-text-case">Change Text Case</h2>
<p>To change the the value to selected textcase within a particular column, use <code>-t</code> or <code>--text_case</code>.
The local variable <code>col</code> and <code>val</code> save the name of column and selected textcase.
If else can prevent the user from inputting incorrect name of column and type of textcase, and restrict the user to input again.
User can return to the main function by typing <code>\q</code>.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_text_case</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of column to change: "</span>) 
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> change_text_case()
    
    val = input(<span class="hljs-string">"\'up\' for upper, \'lo\' for lower or \'ti\' for title: "</span>)
    <span class="hljs-keyword">if</span> val == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()    
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'up'</span>: df[col] = [<span class="hljs-string">' '</span>.join(i.split()).upper() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'lo'</span>: df[col] = [<span class="hljs-string">' '</span>.join(i.split()).lower() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'ti'</span>: df[col] = [<span class="hljs-string">' '</span>.join(i.split()).title() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    <span class="hljs-keyword">else</span>: 
        print(<span class="hljs-string">'Invalid input!'</span>)
        <span class="hljs-keyword">return</span> change_text_case()

    print(<span class="hljs-string">f'The textcase of "<span class="hljs-subst">{col}</span>" is changed.'</span>)
    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result of console:</p>
<pre class="hljs"><code><div>prog -t
[<span class="hljs-string">'Title'</span> <span class="hljs-string">'Surname'</span> <span class="hljs-string">'Given Name'</span> <span class="hljs-string">'E-mail Address'</span> <span class="hljs-string">'Phone Number'</span> <span class="hljs-string">'Position'</span>
 <span class="hljs-string">'Location'</span>]
Name of column to change: Title
<span class="hljs-string">'up'</span> <span class="hljs-keyword">for</span> upper, <span class="hljs-string">'lo'</span> <span class="hljs-keyword">for</span> lower or <span class="hljs-string">'ti'</span> <span class="hljs-keyword">for</span> title: up
The textcase of <span class="hljs-string">"Title"</span> is changed.
</div></code></pre>
<h2 id="sorting">Sorting</h2>
<p>Use <code>-s</code> or <code>--sort</code> to sort the dataframe by selected column.
The local variable <code>col</code> and <code>val</code> save the name of column and selected pattern of sorting.
If else can prevent the user from inputting incorrect name of column and type of pattern, and restrict the user to input again.
User can return to the main function by typing <code>\q</code>.
The index will reset to generate new row numbers series.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sort_by_column</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of column to sort: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> sort_by_column()
    val = input(<span class="hljs-string">"\'as\' for ascending or \'de\' for descending: "</span>)
    <span class="hljs-keyword">if</span> val == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'de'</span>: df = df.sort_values(by=[col], ascending = <span class="hljs-literal">False</span>)
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'as'</span>: df = df.sort_values(by=[col], ascending = <span class="hljs-literal">True</span>)
    <span class="hljs-keyword">else</span>: 
        print(<span class="hljs-string">'Invalid input!'</span>)
        <span class="hljs-keyword">return</span> sort_by_column()
    
    df.reset_index(inplace=<span class="hljs-literal">True</span>)
    <span class="hljs-keyword">del</span> df[<span class="hljs-string">'index'</span>]
    print(<span class="hljs-string">f'The order of "<span class="hljs-subst">{col}</span>" is changed.'</span>)
    <span class="hljs-keyword">return</span> main()
</div></code></pre>
<p>Result in console:</p>
<pre class="hljs"><code><div>prog -s
[<span class="hljs-string">'Title'</span> <span class="hljs-string">'Surname'</span> <span class="hljs-string">'Given Name'</span> <span class="hljs-string">'E-mail Address'</span> <span class="hljs-string">'Phone Number'</span> <span class="hljs-string">'Position'</span>
 <span class="hljs-string">'Location'</span>]
Name of column to sort: Surname
<span class="hljs-string">'as'</span> <span class="hljs-keyword">for</span> ascending or <span class="hljs-string">'de'</span> <span class="hljs-keyword">for</span> descending: as
The order of <span class="hljs-string">"Surname"</span> is changed.
</div></code></pre>
<h2 id="quit">Quit</h2>
<p>Use <code>\q</code> or <code>--quit</code> to exit the program.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">quit_prog</span><span class="hljs-params">()</span>:</span>
    print(<span class="hljs-string">"Thank you and Goodbye"</span>)
    exit()
</div></code></pre>
<h1 id="help-list">Help List</h1>
<p>The help information is generated based on the information commander already knows about the program. The default help option is <code>-h,--help</code>.</p>
<pre class="hljs"><code><div>-p,   --<span class="hljs-built_in">print</span>              Print all dataframe           
-C,   --count_column       Count the number of the cell values of a selected column
-m,   --modify_cell        Modify the selected cell value
-M,   --modify_col_name    Modify the selected column name
-D,   --del_col            Remove the selected column    
-d,   --del_row            Remove the selected row       
-v,   --view_value         View the selected cell value  
-o,   --gen_csv            Generate CSV file <span class="hljs-keyword">for</span> database
-s,   --sort               Sort the dataframe by selected column
-t,   --textcase           Change values textcase        
\q,   --quit               Quit the program              
-h,   --<span class="hljs-built_in">help</span>               Show <span class="hljs-built_in">command</span> list
</div></code></pre>
<h1 id="flow-chart">Flow Chart</h1>
<p><img src="flow-chart.png" alt="alt text" title="flow-chart"></p>
<h1 id="appendix">Appendix</h1>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> re

raw_data = <span class="hljs-literal">None</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">input_csv</span><span class="hljs-params">(raw_data)</span>:</span>
    <span class="hljs-keyword">try</span>:
        csv_file = input(<span class="hljs-string">"Input CSV file (staff_dir.csv): "</span>)
        <span class="hljs-keyword">if</span> csv_file == <span class="hljs-string">'\q'</span>: exit()
        raw_data = pd.read_csv(csv_file)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        print(e)
        <span class="hljs-keyword">return</span> input_csv(raw_data)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> raw_data

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_columns_with_empty_cell</span><span class="hljs-params">(df)</span>:</span>

    df.columns = [<span class="hljs-string">' '</span>.join(i.split()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df.columns]
    empty_cols_name = [value <span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> df.columns <span class="hljs-keyword">if</span> <span class="hljs-string">"Unnamed"</span> <span class="hljs-keyword">in</span> value]
    empty_cols = [col <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> df.columns <span class="hljs-keyword">if</span> df[col].isnull().any()]
    print(<span class="hljs-string">"You have"</span>, len(empty_cols_name), <span class="hljs-string">"columns without naming"</span>)
    print(<span class="hljs-string">"You have"</span>, len(empty_cols), <span class="hljs-string">"columns with empty cells"</span>)

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -M</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modify_column_name</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of column that you want to rename: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> modify_column_name()
    i = input(<span class="hljs-string">"Updated name: "</span>)
    df = df.rename(columns={col: i})
    print(<span class="hljs-string">f'"<span class="hljs-subst">{col}</span>" is changed to "<span class="hljs-subst">{i}</span>".'</span>)

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -m</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modify_cell</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(<span class="hljs-string">"Input row, column and value to a cell that you want to change"</span>)
    print(<span class="hljs-string">"Length of dataframe is"</span>, len(df) - <span class="hljs-number">1</span>, <span class="hljs-string">'\n'</span>, df.columns.values)
    row = input(<span class="hljs-string">"Number of Row: "</span>)
    col = input(<span class="hljs-string">"Name of Column: "</span>)
    <span class="hljs-keyword">if</span> (col == <span class="hljs-string">'\q'</span> <span class="hljs-keyword">or</span> row == <span class="hljs-string">'\q'</span>): <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> row.isnumeric(): <span class="hljs-keyword">return</span> modify_cell()
    row = int(row)
    <span class="hljs-keyword">if</span> row &gt; len(df) - <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> modify_cell()
    value = input(<span class="hljs-string">"Value: "</span>)

    df.iloc[row, df.columns.get_loc(col)] = value
    print(<span class="hljs-string">f'The value of row <span class="hljs-subst">{row}</span> in "<span class="hljs-subst">{col}</span>" is changed to "<span class="hljs-subst">{value}</span>".'</span>)

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -D</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_selected_column</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    i = input(<span class="hljs-string">"Type the name of column to delete: "</span>)
    <span class="hljs-keyword">if</span> i == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> remove_selected_column()
    <span class="hljs-keyword">else</span>: <span class="hljs-keyword">del</span> df[i]

    print(<span class="hljs-string">f'"<span class="hljs-subst">{i}</span>" is removed.'</span>)

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -C</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">counting_with_a_column</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    col = input(<span class="hljs-string">"Select a column to count: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> counting_with_a_column()
    selected_column = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    selected_column = {i: selected_column.count(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> selected_column}
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> selected_column.items():
        print(key, value)

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -d</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">remove_selected_row</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(len(df))
    row = input(<span class="hljs-string">"Number of row to remove: "</span>)
    <span class="hljs-keyword">if</span> row == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> row.isnumeric(): <span class="hljs-keyword">return</span> remove_selected_row()
    row = int(row)
    <span class="hljs-keyword">if</span> row &gt; len(df) - <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> remove_selected_row()
    df.drop([row], axis=<span class="hljs-number">0</span>, inplace=<span class="hljs-literal">True</span>)
    print(<span class="hljs-string">f'Row <span class="hljs-subst">{row}</span> is removed.'</span>)
    
    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -r</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">normalization</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df
    column_with_multi_values = []
    
    <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> list(df.columns):
        df[col] = [<span class="hljs-string">'('</span>.join(i.split(<span class="hljs-string">"\r\n("</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
        <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(df)):
            cell_value = df[col][row]
            cell_value_list = list(map(str, cell_value.split(<span class="hljs-string">"\r\n"</span>)))
            <span class="hljs-keyword">if</span> (len(cell_value_list) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> col <span class="hljs-keyword">in</span> column_with_multi_values): column_with_multi_values.append(col)

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(column_with_multi_values)):
        selected_column = list(column_with_multi_values[i].split(<span class="hljs-string">" "</span>))
        set_index_list = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df.columns <span class="hljs-keyword">if</span> i <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> selected_column]
        df = df.set_index(set_index_list)
        df = df.apply(<span class="hljs-keyword">lambda</span> x: df[column_with_multi_values[i]].str.split(<span class="hljs-string">'\r\n'</span>).explode())
        df = df.reset_index()

    print(<span class="hljs-string">"Normalization is complete"</span>)
    <span class="hljs-keyword">return</span> tidy_dataframe()

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tidy_dataframe</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> list(df.columns):
        <span class="hljs-keyword">if</span> <span class="hljs-string">'E-mail'</span> <span class="hljs-keyword">in</span> i: <span class="hljs-keyword">continue</span>
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'Location'</span> <span class="hljs-keyword">in</span> i: df[i] = [<span class="hljs-string">''</span>.join(i.split()).upper() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'Phone'</span> <span class="hljs-keyword">in</span> i: df[i] = [re.sub(<span class="hljs-string">r"[^A-Za-z0-9]+"</span>, <span class="hljs-string">""</span>, i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'Position'</span> <span class="hljs-keyword">in</span> i:
            df[i] = [<span class="hljs-string">'('</span>.join(i.split(<span class="hljs-string">' ('</span>)).title() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
            df[i] = [i.replace(<span class="hljs-string">"Assoc."</span>, <span class="hljs-string">"Associate"</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
            df[i] = [re.sub(<span class="hljs-string">r"\bProf\b"</span>, <span class="hljs-string">"Professor"</span>, i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]
        <span class="hljs-keyword">else</span>: df[i] = [<span class="hljs-string">' '</span>.join(i.split()).title() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[i]]

    duplicateDFRow = df[df.duplicated()]
    print(<span class="hljs-string">'Duplicated Rows: \n'</span>, duplicateDFRow)
    df = df.drop_duplicates()
    df.reset_index(inplace=<span class="hljs-literal">True</span>)
    <span class="hljs-keyword">del</span> df[<span class="hljs-string">'index'</span>]
    print(<span class="hljs-string">"Diminish spaces and title values"</span>)

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -v</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">receive_cell_value</span><span class="hljs-params">()</span>:</span>
    print(<span class="hljs-string">'Length of the row is'</span>, len(df) - <span class="hljs-number">1</span>)
    row = input(<span class="hljs-string">"Number of Row: "</span>)
    <span class="hljs-keyword">if</span> row == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> row.isnumeric(): <span class="hljs-keyword">return</span> receive_cell_value()
    row = int(row)
    <span class="hljs-keyword">if</span> row &gt; len(df) - <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> receive_cell_value()
    
    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of Column: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> receive_cell_value()
    print(<span class="hljs-string">'The value is'</span>, df.loc[row, col])

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -o</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">to_csv</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    output = input(<span class="hljs-string">"Name of the new csv file: "</span>)
    <span class="hljs-keyword">if</span> output == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    df.to_csv(<span class="hljs-string">f'<span class="hljs-subst">{output}</span>.csv'</span>, index=<span class="hljs-number">0</span>)
    print(<span class="hljs-string">f'<span class="hljs-subst">{output}</span>.csv is generated.'</span>)
    
    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -s</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sort_by_column</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of column to sort: "</span>)
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> sort_by_column()
    val = input(<span class="hljs-string">"\'as\' for ascending or \'de\' for descending: "</span>)
    <span class="hljs-keyword">if</span> val == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'de'</span>: df = df.sort_values(by=[col], ascending = <span class="hljs-literal">False</span>)
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'as'</span>: df = df.sort_values(by=[col], ascending = <span class="hljs-literal">True</span>)
    <span class="hljs-keyword">else</span>: 
        print(<span class="hljs-string">'Invalid input!'</span>)
        <span class="hljs-keyword">return</span> sort_by_column()
    
    df.reset_index(inplace=<span class="hljs-literal">True</span>)
    <span class="hljs-keyword">del</span> df[<span class="hljs-string">'index'</span>]
    print(<span class="hljs-string">f'The order of "<span class="hljs-subst">{col}</span>" is changed.'</span>)

    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># -t</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">change_text_case</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    print(df.columns.values)
    col = input(<span class="hljs-string">"Name of column to change: "</span>) 
    <span class="hljs-keyword">if</span> col == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()
    <span class="hljs-keyword">elif</span> col <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> df.columns.values: <span class="hljs-keyword">return</span> change_text_case()
    
    val = input(<span class="hljs-string">"\'up\' for upper, \'lo\' for lower or \'ti\' for title: "</span>)
    <span class="hljs-keyword">if</span> val == <span class="hljs-string">'\q'</span>: <span class="hljs-keyword">return</span> main()    
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'up'</span>: df[col] = [<span class="hljs-string">' '</span>.join(i.split()).upper() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'lo'</span>: df[col] = [<span class="hljs-string">' '</span>.join(i.split()).lower() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    <span class="hljs-keyword">elif</span> val == <span class="hljs-string">'ti'</span>: df[col] = [<span class="hljs-string">' '</span>.join(i.split()).title() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df[col]]
    <span class="hljs-keyword">else</span>: 
        print(<span class="hljs-string">'Invalid input!'</span>)
        <span class="hljs-keyword">return</span> change_text_case()

    print(<span class="hljs-string">f'The textcase of "<span class="hljs-subst">{col}</span>" is changed.'</span>)
    <span class="hljs-keyword">return</span> main()

<span class="hljs-comment"># \q</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">quit_prog</span><span class="hljs-params">()</span>:</span>
    print(<span class="hljs-string">"Thank you and Goodbye"</span>)
    exit()

<span class="hljs-comment"># -h</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">help_list</span><span class="hljs-params">()</span>:</span>
    print(<span class="hljs-string">"\n%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-p,"</span>, <span class="hljs-string">"--print"</span>, <span class="hljs-string">"Print all dataframe"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-C,"</span>, <span class="hljs-string">"--count_column"</span>, <span class="hljs-string">"Count the number of the cell values of a selected column"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-m,"</span>, <span class="hljs-string">"--modify_cell"</span>, <span class="hljs-string">"Modify the selected cell value"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-M,"</span>, <span class="hljs-string">"--modify_col_name"</span>, <span class="hljs-string">"Modify the selected column name"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-D,"</span>, <span class="hljs-string">"--del_col"</span>, <span class="hljs-string">"Remove the selected column"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-d,"</span>, <span class="hljs-string">"--del_row"</span>, <span class="hljs-string">"Remove the selected row"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-v,"</span>, <span class="hljs-string">"--view_value"</span>, <span class="hljs-string">"View the selected cell value"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-o,"</span>, <span class="hljs-string">"--gen_csv"</span>, <span class="hljs-string">"Generate CSV file for database"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-s,"</span>, <span class="hljs-string">"--sort"</span>, <span class="hljs-string">"Sort the dataframe by selected column"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-t,"</span>, <span class="hljs-string">"--textcase"</span>, <span class="hljs-string">"Change values textcase"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"\q,"</span>, <span class="hljs-string">"--quit"</span>, <span class="hljs-string">"Quit the program"</span>))
    print(<span class="hljs-string">"%-5s %-20s %-30s"</span> % (<span class="hljs-string">"-h,"</span>, <span class="hljs-string">"--help"</span>, <span class="hljs-string">"Show command list\n"</span>))

    <span class="hljs-keyword">return</span> main()

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">global</span> df

    usr_input = input(<span class="hljs-string">'prog '</span>)
    <span class="hljs-keyword">if</span> usr_input == <span class="hljs-string">'-p'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--print'</span>:
        print(df)
        main()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-C'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--count_column'</span>: counting_with_a_column()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-m'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--modify_cell'</span>: modify_cell()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-M'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--modify_col_name'</span>: modify_column_name()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-D'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--remove_col'</span>: remove_selected_column()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-d'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--remove_row'</span>: remove_selected_row()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-v'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--view_value'</span>: receive_cell_value()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-o'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--gen_csv'</span>: to_csv()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-r'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--run'</span>: normalization()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-s'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--sort'</span>: sort_by_column()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-t'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--text_case'</span>: change_text_case()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'\q'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--quit'</span>: quit_prog()
    <span class="hljs-keyword">elif</span> usr_input == <span class="hljs-string">'-h'</span> <span class="hljs-keyword">or</span> usr_input == <span class="hljs-string">'--help'</span>: help_list()
    <span class="hljs-keyword">else</span>:
        print(<span class="hljs-string">"Invalid input. Please type again."</span>)
        main()

<span class="hljs-comment"># Start</span>
print(<span class="hljs-string">"Welcome to the data cleaning program! Type '-h' or '--help' to know the command of the program."</span>)
raw_data = input_csv(raw_data)
df = pd.DataFrame(raw_data)
check_columns_with_empty_cell(df)
</div></code></pre>

</body>
</html>
